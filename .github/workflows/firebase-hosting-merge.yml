# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge # Este es el nombre de tu workflow
on:
  push:
    branches:
      - main # Este workflow se ejecuta cuando haces push a la rama 'main'

jobs:
  build_and_deploy: # Nombre del job
    runs-on: ubuntu-latest # El sistema operativo de la máquina virtual de GitHub Actions

    steps:
      - uses: actions/checkout@v4 # Paso para clonar tu repositorio

      # --- ¡PASO AGREGADO CRUCIAL: Configurar Node.js! ---
      # Esto asegura que el entorno de Node.js esté disponible y que los comandos como 'npm' y los ejecutables de 'node_modules/.bin' estén en el PATH.
      - name: Setup Node.js environment
        uses: actions/setup-node@v4 # Usa la última versión recomendada para esta acción
        with:
          node-version: '20' # <-- IMPORTANTE: Cambia '20' por la versión de Node.js que usas localmente en tu proyecto (ej. '18.x', '22.x').

      # --- ¡PASO AGREGADO CRUCIAL: Instalar Dependencias! ---
      # Este paso instala todas las dependencias listadas en tu package.json, incluyendo 'vite'
      - name: Install dependencies
        run: npm install # O 'yarn install' si usas Yarn en tu proyecto

      # --- Este paso ahora debería encontrar 'vite' ---
      - name: Run build # Nombre de este paso (opcional, pero útil)
        run: npm run build

      - name: Deploy to Firebase Hosting # Nombre de este paso (opcional, pero útil)
        uses: FirebaseExtended/action-hosting-deploy@v0 # La acción de Firebase para desplegar
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }}
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_LAOBRA_478D2 }}
          channelId: live # Despliega a tu canal en vivo (la URL principal)
          projectId: laobra-478d2 # ID de tu proyecto Firebase
